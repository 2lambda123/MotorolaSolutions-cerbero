From 32f26819f765cce5c69917a8184dd470623bd200 Mon Sep 17 00:00:00 2001
From: Edward Hervey <bilboed@bilboed.com>
Date: Tue, 27 Jan 2015 16:27:13 +0100
Subject: [PATCH] gio: Fix build on Android Lollipop

The various nameser headers are public headers starting from Android L
(target arch 21).
---
 gio/gthreadedresolver.c | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

diff --git a/gio/gthreadedresolver.c b/gio/gthreadedresolver.c
index 2ba42f1..a70e8df 100644
--- a/gio/gthreadedresolver.c
+++ b/gio/gthreadedresolver.c
@@ -263,7 +263,7 @@ lookup_by_address_finish (GResolver     *resolver,
 
 #if defined(G_OS_UNIX)
 
-#if defined __BIONIC__ && !defined BIND_4_COMPAT
+#if defined __BIONIC__ && !defined BIND_4_COMPAT && __ANDROID_API__ < 21
 /* Copy from bionic/libc/private/arpa_nameser_compat.h
  * and bionic/libc/private/arpa_nameser.h */
 typedef struct {
@@ -801,7 +801,6 @@ free_records (GList *records)
 
 #if defined(G_OS_UNIX)
 #ifdef __BIONIC__
-#define C_IN 1
 int res_query(const char *, int, int, u_char *, int);
 #endif
 #endif
-- 
2.6.1

